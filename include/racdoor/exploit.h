/* This file is part of Racdoor.
   Copyright (c) 2024 chaoticgd. All rights reversed.
   Released under the BSD-1-Clause license. */

#ifndef _RACDOOR_EXPLOIT_H
#define _RACDOOR_EXPLOIT_H

#include <racdoor/util.h>

typedef struct {
	u16 flag;
	u16 unknown_2;
	u32 unknown_4;
} HelpDatum;

typedef struct {
	char* help_voice_on;
	char* help_text_on;
	
	HelpDatum* help_data_messages;
	u32 help_data_messages_count;
	u32 enabled_help_message;
	
	HelpDatum* help_data_gadgets;
	u32 help_data_gadgets_count;
	u32 enabled_help_gadget;
	
	HelpDatum* help_data_misc;
	u32 help_data_misc_count;
	
	int* help_log_pos;
	
	u32 help_log;
	u32 initial_hook;
	
	u32* trampoline;
	u32 trampoline_target;
} ExploitParams;

/* Setup the initial hook. */
void arm(ExploitParams* params);

#ifdef _EE

/* Clean up after a successful exploitation attempt. */
void disarm(int encrypt);

#endif

#endif
